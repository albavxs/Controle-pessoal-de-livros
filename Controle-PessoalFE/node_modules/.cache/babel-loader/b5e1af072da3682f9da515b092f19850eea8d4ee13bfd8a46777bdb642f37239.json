{"ast":null,"code":"import{useState,useEffect}from\"react\";import{inAxios}from\"../config_axios\";import{useForm}from\"react-hook-form\";import ItemLista from\"./ItemLista\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ManutencaoLivros=()=>{const[livros,setLivros]=useState([]);const{register,handleSubmit,reset}=useForm();const obterLista=async()=>{try{const lista=await inAxios.get(\"livros\");setLivros(lista.data);}catch(error){alert(\"Erro... N\\xE3o foi poss\\xEDvel obter os dados: \".concat(error));}};// define o método que será executado assim que o componente for renderizado\nuseEffect(()=>{obterLista();},[]);const filtrarLista=async campos=>{try{const lista=await inAxios.get(\"livros/filtro/\".concat(campos.palavra));lista.data.length?setLivros(lista.data):alert(\"Não há livros com a palavra-chave pesquisada...\");}catch(error){alert(\"Erro... N\\xE3o foi poss\\xEDvel obter os dados: \".concat(error));}};const excluir=async(id,titulo)=>{if(!window.confirm(\"Confirma a exclus\\xE3o do livro \\\"\".concat(titulo,\"\\\"?\"))){return;}try{await inAxios.delete(\"livros/\".concat(id));setLivros(livros.filter(livro=>livro.id!==id));}catch(error){alert(\"Erro... N\\xE3o foi poss\\xEDvel excluir este livro: \".concat(error));}};const alterar=async(id,titulo,index)=>{const novoPreco=Number(prompt(\"Informe o novo pre\\xE7o do livro \\\"\".concat(titulo,\"\\\"\")));if(isNaN(novoPreco)||novoPreco===0){return;}try{await inAxios.put(\"livros/\".concat(id),{preco:novoPreco});const livrosAlteracao=[...livros];livrosAlteracao[index].preco=novoPreco;setLivros(livrosAlteracao);}catch(error){alert(\"Erro... N\\xE3o foi poss\\xEDvel alterar o pre\\xE7o: \".concat(error));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-7\",children:/*#__PURE__*/_jsx(\"h4\",{className:\"fst-italic mt-3\",children:\"Manuten\\xE7\\xE3o\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-5\",children:/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit(filtrarLista),children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mt-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"T\\xEDtulo ou autor\",required:true,...register(\"palavra\")}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",className:\"btn btn-primary\",value:\"Pesquisar\"}),/*#__PURE__*/_jsx(\"input\",{type:\"button\",className:\"btn btn-danger\",value:\"Todos\",onClick:()=>{reset({palavra:\"\"});obterLista();}})]})})})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped mt-3\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"C\\xF3d.\"}),/*#__PURE__*/_jsx(\"th\",{children:\"T\\xEDtulo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Autor\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ano\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Pre\\xE7o R$\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Foto\"}),/*#__PURE__*/_jsx(\"th\",{children:\"A\\xE7\\xF5es\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:livros.map((livro,index)=>/*#__PURE__*/_jsx(ItemLista,{id:livro.id,titulo:livro.titulo,autor:livro.autor,ano:livro.ano,preco:livro.preco,foto:livro.foto,excluirClick:()=>excluir(livro.id,livro.titulo),alterarClick:()=>alterar(livro.id,livro.titulo,index)},livro.id))})]})]});};export default ManutencaoLivros;","map":{"version":3,"names":["useState","useEffect","inAxios","useForm","ItemLista","jsx","_jsx","jsxs","_jsxs","ManutencaoLivros","livros","setLivros","register","handleSubmit","reset","obterLista","lista","get","data","error","alert","concat","filtrarLista","campos","palavra","length","excluir","id","titulo","window","confirm","delete","filter","livro","alterar","index","novoPreco","Number","prompt","isNaN","put","preco","livrosAlteracao","className","children","onSubmit","type","placeholder","required","value","onClick","map","autor","ano","foto","excluirClick","alterarClick"],"sources":["P:/projects/controle-pessoal-de-livros/Controle-PessoalFE/src/components/ManutencaoLivros.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { inAxios } from \"../config_axios\";\r\nimport { useForm } from \"react-hook-form\";\r\n\r\nimport ItemLista from \"./ItemLista\";\r\n\r\nconst ManutencaoLivros = () => {\r\n  const [livros, setLivros] = useState([]);\r\n  const { register, handleSubmit, reset } = useForm();\r\n\r\n  const obterLista = async () => {\r\n    try {\r\n      const lista = await inAxios.get(\"livros\");\r\n      setLivros(lista.data);\r\n    } catch (error) {\r\n      alert(`Erro... Não foi possível obter os dados: ${error}`);\r\n    }\r\n  };\r\n\r\n  // define o método que será executado assim que o componente for renderizado\r\n  useEffect(() => {\r\n    obterLista();\r\n  }, []);\r\n\r\n  const filtrarLista = async (campos) => {\r\n    try {\r\n      const lista = await inAxios.get(`livros/filtro/${campos.palavra}`);\r\n      lista.data.length\r\n        ? setLivros(lista.data)\r\n        : alert(\"Não há livros com a palavra-chave pesquisada...\");\r\n    } catch (error) {\r\n      alert(`Erro... Não foi possível obter os dados: ${error}`);\r\n    }\r\n  };\r\n\r\n  const excluir = async (id, titulo) => {\r\n    if (!window.confirm(`Confirma a exclusão do livro \"${titulo}\"?`)) {\r\n      return;\r\n    }\r\n    try {\r\n      await inAxios.delete(`livros/${id}`);\r\n      setLivros(livros.filter((livro) => livro.id !== id));\r\n    } catch (error) {\r\n      alert(`Erro... Não foi possível excluir este livro: ${error}`);\r\n    }\r\n  };\r\n\r\n  const alterar = async (id, titulo, index) => {\r\n    const novoPreco = Number(\r\n      prompt(`Informe o novo preço do livro \"${titulo}\"`)\r\n    );\r\n    if (isNaN(novoPreco) || novoPreco === 0) {\r\n      return;\r\n    }\r\n    try {\r\n      await inAxios.put(`livros/${id}`, { preco: novoPreco });\r\n      const livrosAlteracao = [...livros];\r\n      livrosAlteracao[index].preco = novoPreco;\r\n      setLivros(livrosAlteracao);\r\n    } catch (error) {\r\n      alert(`Erro... Não foi possível alterar o preço: ${error}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row\">\r\n        <div className=\"col-sm-7\">\r\n          <h4 className=\"fst-italic mt-3\">Manutenção</h4>\r\n        </div>\r\n        <div className=\"col-sm-5\">\r\n          <form onSubmit={handleSubmit(filtrarLista)}>\r\n            <div className=\"input-group mt-3\">\r\n              <input\r\n                type=\"text\"\r\n                className=\"form-control\"\r\n                placeholder=\"Título ou autor\"\r\n                required\r\n                {...register(\"palavra\")}\r\n              />\r\n              <input\r\n                type=\"submit\"\r\n                className=\"btn btn-primary\"\r\n                value=\"Pesquisar\"\r\n              />\r\n              <input\r\n                type=\"button\"\r\n                className=\"btn btn-danger\"\r\n                value=\"Todos\"\r\n                onClick={() => {\r\n                  reset({ palavra: \"\" });\r\n                  obterLista();\r\n                }}\r\n              />\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n\r\n      <table className=\"table table-striped mt-3\">\r\n        <thead>\r\n          <tr>\r\n            <th>Cód.</th>\r\n            <th>Título</th>\r\n            <th>Autor</th>\r\n            <th>Ano</th>\r\n            <th>Preço R$</th>\r\n            <th>Foto</th>\r\n            <th>Ações</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {livros.map((livro, index) => (\r\n            <ItemLista\r\n              key={livro.id}\r\n              id={livro.id}\r\n              titulo={livro.titulo}\r\n              autor={livro.autor}\r\n              ano={livro.ano}\r\n              preco={livro.preco}\r\n              foto={livro.foto}\r\n              excluirClick={() => excluir(livro.id, livro.titulo)}\r\n              alterarClick={() => alterar(livro.id, livro.titulo, index)}\r\n            />\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ManutencaoLivros;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}